<html>
<head>
<title>Ur/Web Tutorial</title>
<style>
.code {
	background: #d0d0d0;
}
</style>
</head>
<body>
<img src="urheader.png" alt="Ur/Web Tutorial"/></br>
<hr width="99%"/>
<h1>Ur/Web Tutorial</h1>

<h2>Step 6</h2>
<p><a href="step5.html">Previous</a> | <a href="step7.html">Next</a></p>

<p>In this step of the tutorial we are going to introduce one of the rather unique features of Ur/Web.  <em>Metaprogramming</em> over row types allows us to write programs that are able to perform limited computation over the structure of rows.  In practical terms, this means that we can write code that operates independently of the particular table or form inputs, and which can therefore be reused in many different situations.  We're going to demonstrate this by taking a pre-existing component (the <em>Crud</em> -- create, read, update, delete -- example) from the Ur/Web site and apply it to our application to enable the creation and editing of blog entries.</p>

<p>How does this differ from components parameterised on table structure, you might ask?  Well, that's a reasonable way of thinking about some of what this metaprogramming enables, but in Ur/Web it goes further.  We can use familiar programming constructs (e.g. map and fold) to compute new types from old ones.  We can invoke appropriate display functions based upon the types of the fields in a row.  This gives much of the same flexibility that dynamic web languages can provide, however Ur/Web does it in a way that is statically checked at compile time.</p>

<p>The Crud component is reasonably simple.  We'll skip over most explanation of how it actually works, because you can divert back to that later.  The component consists of two files -- a signature and an implementation.</p>

<h3>urblog.urp</h3>

<p>Now we need to include our new crud module:</p>

<pre class="code">
allow url https://github.com/gian/urtutorial/raw/master/step6/style.css
rewrite style Urblog/blogEntry blogEntry
rewrite style Urblog/blogComment blogComment
rewrite style Urblog/commentForm commentForm 
database dbname=urblog
sql urblog.sql

crud
urblog
</pre>

<p><a href="step5.html">Previous</a> | <a href="step7.html">Next</a></p>

</body>
</html>



